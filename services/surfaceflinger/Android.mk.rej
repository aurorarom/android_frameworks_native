diff a/services/surfaceflinger/Android.mk b/services/surfaceflinger/Android.mk	(rejected hunks)
@@ -100,6 +100,53 @@ LOCAL_SHARED_LIBRARIES := \
 	libgui \
 	libpowermanager
 
+# --- MediaTek ---------------------------------------------------------------
+ifneq (, $(findstring MTK_AOSP_ENHANCEMENT, $(COMMON_GLOBAL_CPPFLAGS)))
+	LOCAL_SRC_FILES += \
+		mediatek/DisplayDevice.cpp \
+		mediatek/SurfaceFlinger.cpp \
+		mediatek/DisplayHardware/HWComposer.cpp \
+		mediatek/RenderEngine/RenderEngine.cpp \
+		mediatek/RenderEngine/GLES11RenderEngine.cpp \
+		mediatek/RenderEngine/GLES20RenderEngine.cpp \
+		mediatek/SurfaceFlingerWatchDog.cpp
+endif
+
+ifneq ($(strip $(TARGET_BUILD_VARIANT)), eng)
+	LOCAL_CFLAGS += -DMTK_USER_BUILD
+endif
+
+ifeq ($(MTK_EMULATOR_SUPPORT), yes)
+	LOCAL_CFLAGS += -DMTK_EMULATOR_SUPPORT
+endif
+
+ifeq ($(HAVE_AEE_FEATURE), yes)
+	LOCAL_CFLAGS += -DHAVE_AEE_FEATURE
+	LOCAL_SHARED_LIBRARIES += libaed
+endif
+
+LOCAL_REQUIRED_MODULES += \
+	drm_disable_icon.png
+
+LOCAL_SHARED_LIBRARIES += \
+	libskia \
+	libui_ext \
+	libselinux
+
+LOCAL_C_INCLUDES += \
+	$(TOP)/$(MTK_ROOT)/hardware/include \
+	$(TOP)/$(MTK_ROOT)/hardware/ui_ext/inc \
+	$(TOP)/$(MTK_ROOT)/hardware/gralloc_extra/include \
+	$(TOP)/$(MTK_ROOT)/external/aee/binary/inc \
+	external/skia/include/core \
+	external/skia/include/lazy
+
+ifneq ($(MTK_EMULATOR_SUPPORT), yes)
+LOCAL_STATIC_LIBRARIES += \
+	libsurfaceflinger_mediatek
+endif
+# ----------------------------------------------------------------------------
+
 LOCAL_MODULE:= libsurfaceflinger
 
 include $(BUILD_SHARED_LIBRARY)
@@ -111,7 +158,7 @@ include $(CLEAR_VARS)
 LOCAL_CFLAGS:= -DLOG_TAG=\"SurfaceFlinger\"
 
 LOCAL_SRC_FILES:= \
-	main_surfaceflinger.cpp 
+	main_surfaceflinger.cpp
 
 LOCAL_SHARED_LIBRARIES := \
 	libsurfaceflinger \
@@ -120,6 +167,12 @@ LOCAL_SHARED_LIBRARIES := \
 	libbinder \
 	libutils
 
+# --- MediaTek ---------------------------------------------------------------
+LOCAL_C_INCLUDES := \
+    $(TOP)/$(MTK_ROOT)/hardware/include \
+	$(TOP)/$(MTK_ROOT)/hardware/ui_ext/inc
+# ----------------------------------------------------------------------------
+
 LOCAL_MODULE:= surfaceflinger
 
 ifdef TARGET_32_BIT_SURFACEFLINGER
